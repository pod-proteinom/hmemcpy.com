<!doctype html>




<html class="theme-next mist">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="lYE6Wy4AMVpA-paUiNWFLIZFk8vqATN4AedYdumNuVo" />













  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|Fira Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />






  <link rel="alternate" href="/atom.xml" title="In Absentia" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="Note: this post assumes some knowledge developing Visual Studio Extensions (VSIX).
Suppose you’re developing custom tooling that enhances (or otherwise modifies) current project types (for example, C#">
<meta property="og:type" content="article">
<meta property="og:title" content="Adding a custom property page to existing project types in Visual Studio">
<meta property="og:url" content="http://hmemcpy.com/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/index.html">
<meta property="og:site_name" content="In Absentia">
<meta property="og:description" content="Note: this post assumes some knowledge developing Visual Studio Extensions (VSIX).
Suppose you’re developing custom tooling that enhances (or otherwise modifies) current project types (for example, C#">
<meta property="og:image" content="http://hmemcpy.com/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/prop.png">
<meta property="og:updated_time" content="2016-09-28T11:40:20.194Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Adding a custom property page to existing project types in Visual Studio">
<meta name="twitter:description" content="Note: this post assumes some knowledge developing Visual Studio Extensions (VSIX).
Suppose you’re developing custom tooling that enhances (or otherwise modifies) current project types (for example, C#">
<meta name="twitter:image" content="http://hmemcpy.com/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/prop.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"remove"},
    fancybox: false,
    motion: false,
    duoshuo: {
      userId: undefined,
      author: 'Author'
    }
  };
</script>




  <link rel="canonical" href="http://hmemcpy.com/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/"/>

  <title> Adding a custom property page to existing project types in Visual Studio | In Absentia </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-70273-3', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">In Absentia</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <span class="site-subtitle">by Igal Tabachnik</span>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-rss">
          <a href="/atom.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-rss"></i> <br />
            
            Subscribe
          </a>
        </li>
      
        
        <li class="menu-item menu-item-twitter">
          <a href="https://twitter.com/hmemcpy" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-twitter"></i> <br />
            
            @hmemcpy
          </a>
        </li>
      
        
        <li class="menu-item menu-item-github">
          <a href="https://github.com/hmemcpy" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-github"></i> <br />
            
            GitHub
          </a>
        </li>
      
        
        <li class="menu-item menu-item-linkedin">
          <a href="https://il.linkedin.com/in/igaltabachnik" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-linkedin"></i> <br />
            
            LinkedIn
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Adding a custom property page to existing project types in Visual Studio
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-03-27T19:53:18+00:00" content="2015-03-27">
              2015-03-27
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          
          
          
            <span class="post-edit">
                &nbsp; | &nbsp;
                <i class="fa fa-pencil" aria-hidden="true"></i>
                <a href="https://github.com/hmemcpy/hmemcpy.com/edit/master/source/_posts/2015-03-27-adding-a-custom-property-page-to-existing-project-types-in-visual-studio.md">Edit this page</a>
            </span>
          
          
          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><em>Note: this post assumes some knowledge developing Visual Studio Extensions (VSIX).</em></p>
<p>Suppose you’re developing custom tooling that enhances (or otherwise modifies) current project types (for example, C# class libraries or Web applications). This is most commonly done by specifying custom MSBuild properties, typically by adding a <code>.targets</code> file to the project file itself (possibly via NuGet, which can <a href="http://docs.nuget.org/Release-Notes/NuGet-2.5#automatic-import-of-msbuild-targets-and-props-files" target="_blank" rel="external">import <code>.targets</code> files automatically</a>).</p>
<p>One common way to interact with those custom properties is by adding a page in the project properties, however, most documentation about extending project properties refers to creating your own project systems. Any documentation about extending existing projects is either out of date, or nonexistent.</p>
<a id="more"></a>
<p>But, when there’s a will &ndash; there’s a way. TL;DR: Here’s how to add a custom property page to a regular C# console application:</p>
<ol>
<li>Create an (empty) VSIX project </li>
<li>Add a reference to the following assemblies: <code>Microsoft.VisualStudio.AppDesigner.dll</code> (located in the GAC), and <code>Microsoft.VisualStudio.ManagedInterfaces.dll</code> (from the Visual Studio SDK) </li>
<li>Create a new class that derives from <code>Microsoft.VisualStudio.Editors.PropertyPages.PropPageBase</code> </li>
<li>Implement the class as follows:</li>
</ol>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">[ComVisible(<span class="literal">true</span>)]</div><div class="line">[Guid(<span class="string">"some-guid"</span>)]</div><div class="line">[ProvideObject(<span class="keyword">typeof</span>(MyPropertyPageProvider))]</div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyPropertyPageProvider</span> : <span class="title">PropPageBase</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">protected</span> <span class="keyword">override</span> Type ControlType</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="keyword">typeof</span>(MyPropertyPageControl); &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">string</span> Title</div><div class="line">    &#123; </div><div class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="string">"My Property Page"</span>; &#125; </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> Control <span class="title">CreateControl</span>(<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyPropertyPageControl();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Make sure to provide a new GUID in the <code>GuidAttribute</code> (tip: if you use ReSharper, you can create new GUIDs on the fly by typing <code>nguid</code> and pressing Tab), we will need this GUID again soon. Specify the title of your property page, and provide an instance of a UserControl-derived (WinForms, baby!) page that will be the UI. Visual Studio provides an abstract <code>Microsoft.VisualStudio.Editors.PropertyPages.PropPageUserControlBase</code> class you can derive from.</p>
<p><strong>Important:</strong> Visual Studio will try reading the size of the control from the assembly’s compiled resources &ndash; this requires a .resx file for the user control. Best to create a new User Control using the Add &ndash; User Control context menu (so it can have a .Designer and a .resx files), and change the base type to <code>PropPageUserControlBase</code> afterwards.</p>
<p>One last piece of the puzzle is hooking it up &ndash; this is where a bit of MSBuild magic comes in. After running your extension (in the Experimental Instance), create a new, say, C# Console application. When the project is created, open its .csproj file in Notepad (or your favorite editor), and add the following property into one of the <code>PropertyGroup</code>s (or create your own <code>PropertyGroup</code>, e.g.):</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&lt;PropertyGroup&gt;</div><div class="line">  &lt;CfgPropertyPagesGuidsAddCSharp&gt;&#123;some-guid&#125;&lt;/CfgPropertyPagesGuidsAddCSharp&gt;</div><div class="line">&lt;/PropertyGroup&gt;</div></pre></td></tr></table></figure>
<p>Using the GUID from before. Save the .csproj file, and when you reload it in Visual Studio, you will now have a brand new (albeit empty) property page in the project’s properties!</p>
<img src="/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/prop.png" alt="Hello Property Page!" title="Hello Property Page!">
<p>(You can probably add this property dynamically with DTE from your extension, instead of modifying existing projects, but I haven’t tried it.)</p>
<p>So what happened? Where did <code>CfgPropertyPagesGuidsAddCSharp</code> come from, and what makes it so special? Turns out, after a long investigation, it’s an <em>undocumented</em> property, which is a part of the legacy C# and VB project systems. When Visual Studio processes C# or VB projects, it will look for this property, and attempt to instantiate the COM class at a given GUID. If successful, it will add it as a property page.</p>
<p>I was able to confirm this works in Visual Studio 2013 and 2015, not sure about the earlier editions.</p>
<p>So there you have it, a bit of undocumented functionality makes the impossible possible :)</p>
<p>Happy hacking!</p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/03/disabling-certain-invisibles-in-the-atom-editor/" rel="next" title="Disabling certain "invisibles" in the Atom Editor">
                <i class="fa fa-chevron-left"></i> Disabling certain "invisibles" in the Atom Editor
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/04/preventing-a-certain-windows-update-from-installing-on-windows-10/" rel="prev" title="Preventing a certain Windows Update from installing on Windows 10">
                Preventing a certain Windows Update from installing on Windows 10 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2009 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Igal Tabachnik</span>
  
  
    &nbsp; | &nbsp;
    <span class="cc-license motion-element" itemprop="license">
      <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
        <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
      </a>
    </span>
  
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>











  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'hmemcpy';
      var disqus_identifier = '2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/';
      var disqus_title = "Adding a custom property page to existing project types in Visual Studio";
      var disqus_url = 'http://hmemcpy.com/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  




  
  
  

  

  

</body>
</html>
